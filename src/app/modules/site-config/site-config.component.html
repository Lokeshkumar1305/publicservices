<div class="settings-screen p-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h2-bold text-dark mb-1">Firm Configuration</h1>
      <p class="body-reg text-muted mb-0">Manage your white-labeled application, payment gateways, and active modules.
      </p>
    </div>
    <div class="d-flex gap-3">
      <button mat-stroked-button class="rounded-3 border-light shadow-sm" (click)="previewSite()">
        <mat-icon class="me-1">open_in_new</mat-icon> Portal Preview
      </button>
      <button mat-flat-button color="primary" class="rounded-3 px-4" (click)="saveConfig()">
        <mat-icon class="me-1">save</mat-icon> Deploy Changes
      </button>
    </div>
  </div>

  <mat-card class="border-0 shadow-sm rounded-4 overflow-hidden">
    <mat-tab-group animationDuration="200ms" class="custom-tabs">
      <!-- Branding & UX -->
      <mat-tab>
        <ng-template matTabLabel>
          <div class="d-flex align-items-center gap-2 px-2">
            <mat-icon style="font-size: 20px;">palette</mat-icon>
            <span class="body-med">White Labeling</span>
          </div>
        </ng-template>

        <div class="p-4">
          <div class="row g-4">
            <div class="col-md-6">
              <h3 class="title2-bold mb-4">Branding Visuals</h3>

              <div class="mb-4">
                <label class="form-label caption-bold text-dark">Organization Name</label>
                <input type="text" class="form-control rounded-3" [(ngModel)]="orgDetails.name">
              </div>

              <div class="mb-4">
                <label class="form-label caption-bold text-dark">Primary Color</label>
                <div class="d-flex gap-3 align-items-center">
                  <input type="color" class="form-control form-control-color p-1 rounded-circle"
                    [(ngModel)]="branding.primaryColor">
                  <span class="body-reg text-muted">{{ branding.primaryColor }}</span>
                </div>
                <div class="caption-reg text-muted mt-2">This color will be applied to all primary buttons and
                  indicators in your customer portal.</div>
              </div>

              <div class="mb-4">
                <label class="form-label caption-bold text-dark">Corner Radius (px)</label>
                <input type="number" class="form-control rounded-3" [(ngModel)]="branding.buttonRadius">
              </div>
            </div>

            <div class="col-md-6">
              <div
                class="preview-box p-4 rounded-4 border bg-light h-100 d-flex flex-column align-items-center justify-content-center">
                <div class="caption-bold text-muted text-uppercase mb-3">Live Button Preview</div>
                <button mat-flat-button [style.backgroundColor]="branding.primaryColor"
                  [style.borderRadius.px]="branding.buttonRadius" class="px-5 py-2 text-white">Book Service</button>
                <div class="mt-4 text-center">
                  <img [src]="branding.logoUrl" height="50" alt="Logo Preview" class="opacity-50">
                  <div class="caption-reg text-muted mt-2">Branded Logo</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <!-- Payments Config -->
      <mat-tab>
        <ng-template matTabLabel>
          <div class="d-flex align-items-center gap-2 px-2">
            <mat-icon style="font-size: 20px;">payments</mat-icon>
            <span class="body-med">Payment Config</span>
          </div>
        </ng-template>

        <div class="p-4">
          <div class="row g-4">
            <div class="col-md-8">
              <h3 class="title2-bold mb-4">Financial Gateway Settings</h3>

              <div class="mb-4">
                <label class="form-label caption-bold text-dark">Provider</label>
                <select class="form-select rounded-3" [(ngModel)]="paymentConfig.provider">
                  <option value="Stripe">Stripe (Recommended)</option>
                  <option value="PayPal">PayPal Business</option>
                  <option value="Razorpay">Razorpay</option>
                </select>
              </div>

              <div class="mb-4">
                <label class="form-label caption-bold text-dark">Secret API Key *</label>
                <input type="password" class="form-control rounded-3" [(ngModel)]="paymentConfig.apiKey">
              </div>

              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label caption-bold text-dark">Currency</label>
                  <select class="form-select rounded-3" [(ngModel)]="paymentConfig.currency">
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - Pound Sterling</option>
                  </select>
                </div>
                <div class="col-md-6 d-flex align-items-end pb-1 px-4">
                  <mat-slide-toggle color="primary" [(ngModel)]="paymentConfig.autoInvoice">Auto-generate
                    Invoices</mat-slide-toggle>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="alert alert-info border-0 rounded-4 p-4 shadow-sm">
                <div class="d-flex gap-2 mb-2">
                  <mat-icon class="text-primary">verified_user</mat-icon>
                  <div class="body-bold">PCI Compliance</div>
                </div>
                <div class="caption-reg text-muted">
                  Toucan does not store full card details. All financial transactions are tokenized through {{
                  paymentConfig.provider }}.
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <!-- Modules Hub -->
      <mat-tab>
        <ng-template matTabLabel>
          <div class="d-flex align-items-center gap-2 px-2">
            <mat-icon style="font-size: 20px;">grid_view</mat-icon>
            <span class="body-med">Modules Hub</span>
          </div>
        </ng-template>

        <div class="p-4">
          <h3 class="title2-bold mb-4">Enable/Disable Application Features</h3>
          <div class="row g-3">
            <div class="col-md-6" *ngFor="let mod of moduleControl">
              <div class="module-toggle-card p-3 rounded-4 border d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">
                  <div class="icon-circle bg-light d-flex align-items-center justify-content-center rounded-circle"
                    style="width: 40px; height: 40px;">
                    <mat-icon class="text-indigo" style="font-size: 20px;">settings_suggest</mat-icon>
                  </div>
                  <div>
                    <div class="body-bold">{{ mod.name }}</div>
                    <div class="caption-reg text-muted">{{ mod.tooltip }}</div>
                  </div>
                </div>
                <mat-slide-toggle color="primary" [(ngModel)]="mod.enabled"></mat-slide-toggle>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </mat-card>
</div>